<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="css/main.css">
    <title>rndD ya-shri</title>
</head>
<body class="page">

<div class="control-panel-container">
    <div class="control-panel">
        <button class="button control-panel__button-clear">
            Очистить
        </button>
        <button class="button control-panel__button-import">
            Импорт
        </button>
        <button class="button control-panel__button-export">
            Экспорт
        </button>
        <button class="button control-panel__button-add">
            Добавить
        </button>
        <button class="button control-panel__button-tell-a-joke">
            Рассказать анекдот
        </button>
    </div>
</div>

<div class="container">
    <div class="timeline line">

        <div class="timeline__spine-container">
           <div class="timeline__spine"></div>
        </div>

    </div>
</div>


<!--Templates-->
<div class="template">

    <div class="template__event">
        <div class="event-container__pointer"></div>
        <div class="event-container__event event">
            <div class="event__header">{{ dateFromNow }} {{- name }} от {{- speakerName }}</div>
            <div class="event__description">
                {{- description }}
            </div>
            <div class="event__controls event-controls">
                <button class="event-controls__remove">Удалить</button>
                <button class="event-controls__edit">Редактировать</button>
            </div>
        </div>

        <form class="edit-form event-container__edit-form">
            <label class="edit-form__label">
                Название:
                <input class="edit-form__name" name="name" type="text" value="{{- name }}"/>
            </label>
            <label class="edit-form__label">
                Докладчик:
                <input class="edit-form__speakerName" name="speakerName" type="text" value="{{- speakerName }}"/>
            </label>
            <label class="edit-form__label">
                Дата-время:
                <input class="edit-form__date" type="text" name="date" value="{{ calendarDatetime }}"/>
            </label>
            <label class="edit-form__label">
                Тезисы:
                <textarea class="edit-form__description" name="description">{{- description }}</textarea>
            </label>
            <label class="edit-form__label">
                Ссылка на презентацию:
                <input class="edit-form__presentation" name="presentation" type="text"/>
            </label>

            <input type="submit" value="Сохранить" />
        </form>
    </div>



    <div class="event-container event-container_position_left">
        <div class="event-container__pointer"></div>
        <div class="event">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse bibendum nibh eu justo cursus id porta nibh adipiscing. Ut tincidunt diam eget lacus suscipit faucibus eleifend risus porttitor. Vestibulum magna leo, rhoncus eget elementum vitae, malesuada eu mi. Aliquam erat volutpat. Ut a augue ac tortor tempus bibendum ac nec erat. Pellentesque aliquam tempus lectus, eget luctus enim tempor at. Sed viverra vestibulum massa, ac dictum odio faucibus nec. Vivamus quis eros non enim laoreet placerat et ut lectus. Praesent luctus nisl ac ipsum fermentum in gravida odio tincidunt. Quisque lacus lectus, convallis quis rutrum vitae, molestie et elit. Pellentesque sed velit et enim varius dapibus. Lorem ipsum dolor sit amet, consectetur adipiscing elit.

            Sed vitae arcu sit amet lacus adipiscing commodo. Maecenas lorem urna, mollis laoreet ullamcorper eu, eleifend adipiscing enim. Curabitur at rutrum massa. Quisque id tellus non risus posuere adipiscing. Sed cursus consequat velit, vel convallis augue interdum eu. Donec in ante vel urna pellentesque faucibus laoreet ut lectus. Nulla nulla purus, iaculis et vulputate id, euismod eu arcu.

        </div>
    </div>

    <div class="event-container event-container_position_right">
        <div class="event-container__pointer"></div>
        <div class="event">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse bibendum nibh eu justo cursus id porta nibh adipiscing. Ut tincidunt diam eget lacus suscipit faucibus eleifend risus porttitor. Vestibulum magna leo, rhoncus eget elementum vitae, malesuada eu mi. Aliquam erat volutpat. Ut a augue ac tortor tempus bibendum ac nec erat. Pellentesque aliquam tempus lectus, eget luctus enim tempor at. Sed viverra vestibulum massa, ac dictum odio faucibus nec. Vivamus quis eros non enim laoreet placerat et ut lectus. Praesent luctus nisl ac ipsum fermentum in gravida odio tincidunt. Quisque lacus lectus, convallis quis rutrum vitae, molestie et elit. Pellentesque sed velit et enim varius dapibus. Lorem ipsum dolor sit amet, consectetur adipiscing elit.

            Sed vitae arcu sit amet lacus adipiscing commodo. Maecenas lorem urna, mollis laoreet ullamcorper eu, eleifend adipiscing enim. Curabitur at rutrum massa. Quisque id tellus non risus posuere adipiscing. Sed cursus consequat velit, vel convallis augue interdum eu. Donec in ante vel urna pellentesque faucibus laoreet ut lectus. Nulla nulla purus, iaculis et vulputate id, euismod eu arcu.


        </div>
    </div>

    <div class="event-container event-container_position_center">
        <div class="event-container__pointer"></div>
        <div class="event">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse bibendum nibh eu justo cursus id porta nibh adipiscing. Ut tincidunt diam eget lacus suscipit faucibus eleifend risus porttitor. Vestibulum magna leo, rhoncus eget elementum vitae, malesuada eu mi. Aliquam erat volutpat. Ut a augue ac tortor tempus bibendum ac nec erat. Pellentesque aliquam tempus lectus, eget luctus enim tempor at. Sed viverra vestibulum massa, ac dictum odio faucibus nec. Vivamus quis eros non enim laoreet placerat et ut lectus. Praesent luctus nisl ac ipsum fermentum in gravida odio tincidunt. Quisque lacus lectus, convallis quis rutrum vitae, molestie et elit. Pellentesque sed velit et enim varius dapibus. Lorem ipsum dolor sit amet, consectetur adipiscing elit.

            Sed vitae arcu sit amet lacus adipiscing commodo. Maecenas lorem urna, mollis laoreet ullamcorper eu, eleifend adipiscing enim. Curabitur at rutrum massa. Quisque id tellus non risus posuere adipiscing. Sed cursus consequat velit, vel convallis augue interdum eu. Donec in ante vel urna pellentesque faucibus laoreet ut lectus. Nulla nulla purus, iaculis et vulputate id, euismod eu arcu.

        </div>
    </div>
</div>

<!--Js-->
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/1.7.2/moment.min.js"></script>
<script src="https://raw.github.com/timrwood/moment/master/lang/ru.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.1/underscore-min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/backbone-localstorage.js/1.0/backbone.localStorage-min.js"></script>
<script src="js/libs/bem.backbone.js"></script>

<script src="js/models/event.js"></script>
<script src="js/views/event.js"></script>
<script src="js/collections/events-list.js"></script>
<script src="js/views/scheduler.js"></script>

<script>

$(function(){
    //язык для moment.js
    moment.lang('ru');
    //формат данных для форм, и выдачи даты-времени
    schedulerApp.datetimeFormat = 'DD.MM.YYYY HH:mm';

    _.templateSettings.interpolate = /\{\{(.*?)\}\}/g;

    var app = new schedulerApp.AppView();
    $(".control-panel__button-clear").on("click", function() {
        schedulerApp.Events.trigger('clear');
    });

    $(".control-panel__button-import").on("click", function() {
        var data = prompt("Вставте сюда данные:");
        try {
            var success = true;
            var events = JSON.parse(data);
            if(!events){
                success = false;
            }
        } catch(e) {
            if((e.name && e.name == "SyntaxError") || e == "SyntaxError") {
                alert("Error: Не валидные данные");
            } else {
                alert("Error");
            }
            success = false;
        }
        if(success) {
            schedulerApp.Events.importEvents(events);
        }
    });

    $(".control-panel__button-export").on("click", function() {
        prompt(
            "Скопируйте это и сохрание:",
            schedulerApp.Events.toJSON()
        );
    });

    $(".control-panel__button-add").on("click", function() {
        schedulerApp.Events.addNew();
    });

    $(".control-panel__button-tell-a-joke").on("click", function() {
        alert('Заходит джавист в столовую и говорит "Паблик статик файнал Борщ борщ равно нью Борщ, пожалуйста"');
    });

    if(schedulerApp.Events.length === 0){
        if(confirm("БД совсем пуста, может быть вам загрузить пару тройку дефолтных записей?")){
            var events = [{"name":"Лекция по Javascript","date":1350578400,"theme":"Тема","description":"","speakerName":"azproduction","presentationUrl":"http://","presentation":"","id":"21647d91-17e3-eb14-21e2-e7f2c50e279e"},{"name":"Лекция XSLT","date":1350492000,"theme":"Тема","description":"","speakerName":"azproduction","presentationUrl":"http://","presentation":"","id":"56f0fba9-a2d0-dd00-7673-638d734b61cb"},{"name":"Лекция CSS","date":1350319200,"theme":"Тема","description":"","speakerName":"Veget","presentationUrl":"http://","presentation":"","id":"77cfd872-22e5-ac04-7dd8-f0375bcc7b7a"},{"name":"Лекция про шаблонизаторы","date":1350312000,"theme":"Тема","description":"","speakerName":"Veget","presentationUrl":"http://","presentation":"","id":"f206c3f6-2c9a-3045-f57a-82c94a765be5"},{"name":"Лекция Debuger","date":1350060000,"theme":"Тема","description":"","speakerName":"Mishanga","presentationUrl":"http://","presentation":"","id":"dd189fdf-b325-7d4c-dca2-1afa4b3235a0"},{"name":"Лекция BEM","date":1349541600,"theme":"Тема","description":"","speakerName":"Veget","presentationUrl":"http://","presentation":"","id":"1a56f2db-785d-bae4-67da-d05a4a289737"},{"name":"Факультатив BEM","date":1349452800,"theme":"Тема","description":"","speakerName":"Veget","presentationUrl":"http://","presentation":"","id":"bcedfa39-cd6f-aaa6-343e-89587707df49"},{"name":"Лекция дизайн","date":1349109600,"theme":"Тема","description":"","speakerName":"Mishanga","presentationUrl":"http://","presentation":"","id":"eefa64b1-efd2-fc73-35d6-b2724af3ec11"}];
            schedulerApp.Events.importEvents(events);
        }
    }

});

</script>




</body>
</html>